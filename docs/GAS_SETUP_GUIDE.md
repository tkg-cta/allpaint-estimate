# Google Apps Script メール送信機能 - セットアップガイド

このガイドでは、お問い合わせフォームからメールを送信できるようにGoogle Apps Scriptを設定する手順を説明します。

## 📋 前提条件

- Googleアカウント (`takagi.chita@gmail.com`)
- 約15分の作業時間

---

## 🚀 セットアップ手順

### ステップ1: Google Apps Scriptプロジェクトを作成

1. **Google Apps Scriptにアクセス**
   - ブラウザで https://script.google.com/ を開く
   - Googleアカウント (`takagi.chita@gmail.com`) でログイン

2. **新しいプロジェクトを作成**
   - 左上の「新しいプロジェクト」をクリック

3. **スクリプトをコピー&ペースト**
   - プロジェクトフォルダ内の `gas-script.js` ファイルを開く
   - 全てのコードをコピー
   - Google Apps Scriptエディタに貼り付け（既存のコードを全て置き換える）

4. **プロジェクト名を変更**
   - 左上の「無題のプロジェクト」をクリック
   - 「お問い合わせフォーム送信」などの名前に変更
   - 「名前を変更」をクリック

---

### ステップ2: Webアプリとしてデプロイ

1. **デプロイを開始**
   - 右上の「デプロイ」ボタンをクリック
   - 「新しいデプロイ」を選択

2. **設定を行う**
   - **種類**: 歯車アイコン⚙️をクリック → 「ウェブアプリ」を選択
   - **説明**: 「お問い合わせフォーム v1」など
   - **次のユーザーとして実行**: 「自分 (takagi.chita@gmail.com)」を選択
   - **アクセスできるユーザー**: 「全員」を選択

3. **承認を行う**
   - 「デプロイ」ボタンをクリック
   - 「アクセスを承認」をクリック
   - アカウントを選択
   - 「詳細」→「(プロジェクト名)に移動」をクリック
   - 「許可」をクリック

4. **WebアプリURLをコピー**
   - デプロイ完了後、「ウェブアプリ」のURLが表示されます
   - このURLをコピーしてください
   - 例: `https://script.google.com/macros/s/AKfycbz.../exec`

---

### ステップ3: ReactアプリにURLを設定

1. **プロジェクトフォルダを開く**
   - VSCodeまたはエディタで `/Users/webjigyoubutkg/Documents/CODE/allpaint-estimate` を開く

2. **.env.localファイルを作成**
   - `.env.local.example` をコピーして `.env.local` を作成
   - または、新規ファイル `.env.local` を作成

3. **URLを設定**
   - `.env.local` ファイルに以下を記述:
   ```
   VITE_GAS_WEBHOOK_URL=https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec
   ```
   - `YOUR_SCRIPT_ID` の部分を、ステップ2-4でコピーしたURLに置き換える

4. **開発サーバーを再起動**
   - ターミナルで `Ctrl+C` を押して開発サーバーを停止
   - `npm run dev` で再起動

---

### ステップ4: 動作確認

1. **フォームにアクセス**
   - ブラウザで `http://localhost:3000` を開く

2. **テスト送信**
   - フォームに適当な情報を入力
   - 最後まで進んで「この内容で送信」をクリック

3. **メール受信確認**
   - `c-takagi@chita.co.jp` のメールボックスを確認
   - 件名「【お問い合わせ】全塗装シミュレーターからのお問い合わせ」のメールが届いているか確認

---

## 🔧 トラブルシューティング

### メールが届かない場合

1. **GASのログを確認**
   - Google Apps Scriptエディタで「実行数」をクリック
   - エラーが表示されていないか確認

2. **迷惑メールフォルダを確認**
   - `c-takagi@chita.co.jp` の迷惑メールフォルダを確認

3. **URLが正しいか確認**
   - `.env.local` のURLが正しくコピーされているか確認
   - URLの最後が `/exec` で終わっているか確認

4. **ブラウザのコンソールを確認**
   - F12キーを押して開発者ツールを開く
   - Consoleタブでエラーが表示されていないか確認

---

## 📝 補足情報

### 送信制限
- **1日100通まで** (Googleアカウントの制限)
- 通常のお問い合わせフォームには十分な数です

### セキュリティ
- GASのURLは公開されますが、悪用を防ぐため以下を推奨:
  - 定期的にデプロイを更新してURLを変更
  - 必要に応じてreCAPTCHAを追加

### カスタマイズ
- メール本文の形式を変更したい場合は `gas-script.js` の `createEmailBody` 関数を編集
- 送信先を追加したい場合は `CONFIG.TO_EMAIL` をカンマ区切りで複数指定可能

---

## ✅ 完了！

これでお問い合わせフォームからメールが送信できるようになりました！
