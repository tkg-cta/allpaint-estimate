作成日: 2025-12-05

# 全塗装シミュレーター システム仕様書

## 1. システム概要

本システムは、自動車の全塗装（オールペイント）にかかる費用を、ユーザーがWeb上で手軽に見積もりシミュレーションできるアプリケーションです。
車両タイプ、塗装タイプ、各種オプションを選択することで、概算見積もりをリアルタイムに算出し、店舗への問い合わせ（メール送信）までを一貫して行います。

### 主な機能
- **見積もりシミュレーション**: 車両、塗装、オプションを選択し、合計金額を算出。
- **リアルタイム計算**: 選択内容に応じて即座に見積もり金額を更新。
- **問い合わせフォーム**: ユーザー情報と見積もり内容を店舗へ送信。
- **メール自動送信**: Google Apps Script (GAS) を利用したメール通知機能。

## 2. 画面遷移フロー

アプリケーションは「ステップウィザード形式」を採用しており、以下の順序で進行します。

1.  **Step 1: 車両選択**
    - 軽自動車、コンパクトカー、セダン、SUV、ミニバン、ワンボックスから選択。
    - 選択した車両によって基本料金（塗装タイプごとの価格）が決定される。
2.  **Step 2: 塗装タイプ選択**
    - ソリッド、メタリック、パールから選択。
    - 車両タイプと塗装タイプの組み合わせで「基本塗装料金」が確定する。
3.  **Step 3: オプション選択**
    - 下地処理、部品脱着、特殊塗装、コーティングなどのオプションを選択。
    - オプションには「固定価格」「車両サイズ別価格」「個数指定（パネル数など）」の3パターンがある。
4.  **Step 4: 見積もり確認**
    - 選択した内容と合計金額の概算を表示。
    - 「お問い合わせへ進む」ボタンで次へ。
5.  **Step 5: お客様情報入力**
    - 名前、ふりがな、電話番号、メールアドレス、来店希望日時、問い合わせ内容を入力。
    - 「来店して見積もり」か「問い合わせのみ」かを選択可能。
6.  **Step 6: 最終確認**
    - 入力内容の最終確認画面。
    - 「送信」ボタン押下でGASへデータをPOST送信。
7.  **完了画面**
    - 送信完了メッセージと、LINE公式アカウントへの誘導を表示。

## 3. データ構造

### 3.1 車両定義 (`VehicleType`)
車両はサイズ区分 (`VehicleSize`) を持ち、塗装タイプごとの価格が定義されています。

| ID | 名称 | サイズ区分 | 価格設定 |
| :--- | :--- | :--- | :--- |
| `kei` | 軽自動車 | `LIGHT` | ソリッド: ¥100,000 / メタリック: ¥120,000 / パール: ¥140,000 |
| `compact` | コンパクトカー | `REGULAR` | ソリッド: ¥120,000 / メタリック: ¥140,000 / パール: ¥160,000 |
| `sedan` | 中型セダン | `REGULAR` | ソリッド: ¥140,000 / メタリック: ¥160,000 / パール: ¥180,000 |
| `suv` | SUV | `LARGE` | ソリッド: ¥160,000 / メタリック: ¥180,000 / パール: ¥200,000 |
| `minivan` | ミニバン | `LARGE` | ソリッド: ¥180,000 / メタリック: ¥200,000 / パール: ¥220,000 |
| `onebox` | ワンボックス | `LARGE` | ソリッド: ¥200,000 / メタリック: ¥220,000 / パール: ¥240,000 |

### 3.2 塗装タイプ定義 (`PaintType`)
| ID | 名称 | 説明 |
| :--- | :--- | :--- |
| `solid` | ソリッド | 単色。シンプルで力強い発色。 |
| `metallic` | メタリック | 金属片を含んだ塗料。キラキラとした輝き。 |
| `pearl` | パール | 真珠のような光沢と高級感。 |

### 3.3 オプション定義 (`OptionItem`)
オプションは価格設定タイプ (`PricingType`) により計算ロジックが異なります。

- **FIXED**: 車両サイズに関わらず固定価格。
- **VARIES_BY_SIZE**: 車両サイズ (`LIGHT`, `REGULAR`, `LARGE`) ごとに価格が変動。
- **PER_UNIT**: 単価 × 個数（パネル数など）で計算。

**主なオプション例:**
- クリアー剥離 (PER_UNIT): ¥10,000/パネル
- 外廻り脱着セット (VARIES_BY_SIZE): 軽¥25,000 / 普通¥35,000 / 大型¥45,000
- ガラス脱着セット (FIXED): ¥50,000

## 4. 外部システム連携

### Google Apps Script (GAS)
問い合わせデータの送信先としてGASのWebアプリを利用しています。

- **エンドポイント**: `.env.local` の `VITE_GAS_WEBHOOK_URL` で設定。
- **通信方式**: HTTP POST (JSON)
- **データ形式**:
  ```json
  {
    "customer": { ...お客様情報... },
    "quote": {
      "vehicle": { ...選択車両... },
      "paint": { ...選択塗装... },
      "options": [ ...選択オプション詳細... ],
      "totalPrice": 123456
    }
  }
  ```
- **処理内容**:
  1.  受信したJSONデータをパース。
  2.  店舗向けメールを作成・送信。
  3.  （オプション）スプレッドシートへの記録など（スクリプト側で拡張可能）。

## 5. 技術スタック

- **Frontend**: React 19, TypeScript
- **Build Tool**: Vite
- **Styling**: Tailwind CSS
- **Icons**: Lucide React
- **Backend (Mail)**: Google Apps Script
- **Hosting**: GitHub Pages
